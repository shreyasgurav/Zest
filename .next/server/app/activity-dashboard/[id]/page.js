(()=>{var e={};e.id=7086,e.ids=[7086],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},81068:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>n});var a=s(50482),i=s(69108),r=s(62563),o=s.n(r),c=s(68300),l={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>c[e]);s.d(t,l);let n=["",{children:["activity-dashboard",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5037)),"/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/activity-dashboard/[id]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,39258)),"/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/activity-dashboard/[id]/page.tsx"],u="/activity-dashboard/[id]/page",h={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/activity-dashboard/[id]/page",pathname:"/activity-dashboard/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},81146:(e,t,s)=>{Promise.resolve().then(s.bind(s,83112))},83112:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(95344),i=s(3729),r=s(8428),o=s(81012),c=s(87097),l=s(14408),n=s(27022),d=s.n(n),u=s(49921);let h=()=>{let e=(0,r.useParams)(),t=(0,r.useRouter)(),s=(0,l.v0)(),n=e?.id,[h,m]=(0,i.useState)([]),[y,p]=(0,i.useState)(null),[x,_]=(0,i.useState)(!0),[v,b]=(0,i.useState)(null),[j,D]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(!n){b("No activity ID provided"),_(!1);return}N(),A(),q()},[n]);let N=async()=>{if(!s.currentUser||!n){D(!1);return}try{let e=await (0,c.QT)((0,c.JU)(o.db,"activities",n));if(e.exists()){let t=e.data();D(t.organizationId===s.currentUser.uid)}}catch(e){console.error("Error checking authorization:",e),D(!1)}},A=async()=>{if(n)try{let e=await (0,c.QT)((0,c.JU)(o.db,"activities",n));e.exists()&&p({id:e.id,...e.data()})}catch(e){console.error("Error fetching activity data:",e)}},q=async()=>{if(n)try{_(!0),console.log("Fetching attendees for activityId:",n);let e=(0,c.hJ)(o.db,"activityAttendees"),t=(0,c.IO)(e,(0,c.ar)("activityId","==",n),(0,c.Xo)("createdAt","desc")),s=await (0,c.PL)(t);if(s.empty)console.log("No attendees found for activityId:",n),m([]);else{let e=s.docs.map(e=>({id:e.id,...e.data()}));console.log("Attendees fetched:",e),m(e)}}catch(e){console.error("Error fetching attendees:",e),b(e instanceof Error?e.message:"An error occurred")}finally{_(!1)}},P=async()=>{if(j&&n)try{let e=(0,c.hJ)(o.db,"activityAttendees"),s=(0,c.IO)(e,(0,c.ar)("activityId","==",n)),a=(await (0,c.PL)(s)).docs.map(e=>(0,c.oe)(e.ref));await Promise.all(a);let i=(0,c.hJ)(o.db,"activity_bookings"),r=(0,c.IO)(i,(0,c.ar)("activityId","==",n)),l=(await (0,c.PL)(r)).docs.map(e=>(0,c.oe)(e.ref));await Promise.all(l),await (0,c.oe)((0,c.JU)(o.db,"activities",n)),t.push("/"),t.refresh()}catch(e){console.error("Error deleting activity:",e),b("Failed to delete activity. Please try again.")}};return x?a.jsx("div",{className:d().activityDashboard,children:a.jsx("div",{className:d().loadingState,children:"Loading attendees..."})}):v?a.jsx("div",{className:d().activityDashboard,children:(0,a.jsxs)("div",{className:d().errorState,children:["Error: ",v]})}):(0,a.jsxs)("div",{className:d().activityDashboard,children:[(0,a.jsxs)("div",{className:d().dashboardHeader,children:[a.jsx("h1",{className:d().title,children:y?.name||"Activity Dashboard"}),j&&(0,a.jsxs)("div",{className:d().actionButtons,children:[(0,a.jsxs)("button",{onClick:()=>{t.push(`/edit-activity/${n}`)},className:d().editButton,title:"Edit Activity",children:[a.jsx(u.fmQ,{})," Edit Activity"]}),(0,a.jsxs)("button",{onClick:()=>f(!0),className:d().deleteButton,title:"Delete Activity",children:[a.jsx(u.Xm5,{})," Delete Activity"]})]})]}),g&&(0,a.jsxs)("div",{className:d().deleteConfirmation,children:[a.jsx("p",{children:"Are you sure you want to delete this activity? This action cannot be undone."}),(0,a.jsxs)("div",{className:d().confirmationButtons,children:[a.jsx("button",{onClick:P,className:d().confirmDeleteButton,children:"Yes, Delete Activity"}),a.jsx("button",{onClick:()=>f(!1),className:d().cancelDeleteButton,children:"Cancel"})]})]}),v&&a.jsx("div",{className:d().errorState,children:v}),0===h.length?a.jsx("div",{className:d().emptyState,children:"No attendees found for this activity."}):(0,a.jsxs)("table",{className:d().table,children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:d().tableHeader,children:"Name"}),a.jsx("th",{className:d().tableHeader,children:"Email"}),a.jsx("th",{className:d().tableHeader,children:"Phone"}),a.jsx("th",{className:d().tableHeader,children:"Tickets"}),a.jsx("th",{className:d().tableHeader,children:"Date"}),a.jsx("th",{className:d().tableHeader,children:"Time Slot"})]})}),a.jsx("tbody",{children:h.map(e=>(0,a.jsxs)("tr",{className:d().tableRow,children:[a.jsx("td",{className:d().tableCell,children:e.name}),a.jsx("td",{className:`${d().tableCell} ${d().email}`,children:e.email}),a.jsx("td",{className:`${d().tableCell} ${d().phoneNumber}`,children:e.phone}),a.jsx("td",{className:d().tableCell,children:(0,a.jsxs)("div",{className:d().statusBadge,children:[e.tickets," tickets"]})}),a.jsx("td",{className:d().tableCell,children:e.selectedDate}),(0,a.jsxs)("td",{className:`${d().tableCell} ${d().timeSlot}`,children:[e.selectedTimeSlot.start_time," - ",e.selectedTimeSlot.end_time]})]},e.id))})]})]})}},27022:e=>{e.exports={activityDashboard:"ActivityDashboard_activityDashboard__smdCx",title:"ActivityDashboard_title__tBN8n",table:"ActivityDashboard_table__EVM71",tableHeader:"ActivityDashboard_tableHeader__DtnjW",tableCell:"ActivityDashboard_tableCell__lwhFr",tableRow:"ActivityDashboard_tableRow__T_Xke",statusBadge:"ActivityDashboard_statusBadge__CCXxg",loadingState:"ActivityDashboard_loadingState__4q_mN",errorState:"ActivityDashboard_errorState__j5Dee",emptyState:"ActivityDashboard_emptyState__Wuzl3",timeSlot:"ActivityDashboard_timeSlot__QSIYe",phoneNumber:"ActivityDashboard_phoneNumber___3l7B",email:"ActivityDashboard_email___nUKk",dashboardHeader:"ActivityDashboard_dashboardHeader__DG0Mf",actionButtons:"ActivityDashboard_actionButtons__hiVyj",editButton:"ActivityDashboard_editButton___nacX",deleteButton:"ActivityDashboard_deleteButton__mj6UH",deleteConfirmation:"ActivityDashboard_deleteConfirmation__bi1Sy",confirmationButtons:"ActivityDashboard_confirmationButtons__v_tQ4",confirmDeleteButton:"ActivityDashboard_confirmDeleteButton__O6pKb",cancelDeleteButton:"ActivityDashboard_cancelDeleteButton__q6PyC"}},5037:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>i,default:()=>o});let a=(0,s(86843).createProxy)(String.raw`/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/activity-dashboard/[id]/page.tsx`),{__esModule:i,$$typeof:r}=a,o=a.default}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[1638,4292,4684],()=>s(81068));module.exports=a})();