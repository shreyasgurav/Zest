(()=>{var e={};e.id=2626,e.ids=[2626],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},85158:e=>{"use strict";e.exports=require("http2")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},84448:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>c,routeModule:()=>m,tree:()=>u});var o=t(50482),n=t(69108),s=t(62563),i=t.n(s),a=t(68300),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);t.d(r,l);let u=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,91613)),"/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/login/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,39258)),"/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/login/page.tsx"],d="/login/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new o.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},46336:(e,r,t)=>{Promise.resolve().then(t.bind(t,85575))},85575:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>w});var o=t(95344),n=t(3729),s=t(8428),i=t(14408),a=t(81012),l=t(76041),u=t(48201),c=t(12521),d=t.n(c);let p=({disabled:e,onClick:r})=>(0,o.jsxs)("button",{className:d().googleButton,disabled:e,onClick:r,children:[o.jsx("img",{src:"/google-icon.svg",alt:"Google logo",className:d().googleIcon}),o.jsx("span",{className:d().buttonText,children:"Sign in with Google"})]});var m=t(22734),g=t.n(m),h=t(59753);let x=function({onSuccess:e}){(0,s.useRouter)();let[r,t]=(0,n.useState)(!1);async function c(){if(!r){t(!0),console.log("\uD83D\uDD35 Starting Google Sign-in process...");try{await (0,i.Fb)(a.I8,i.a$),console.log("\uD83D\uDD35 Persistence set to local storage");let r=new i.hJ;r.setCustomParameters({prompt:"select_account"}),console.log("\uD83D\uDD35 Google provider configured");let t=(await (0,i.rh)(a.I8,r)).user;if(console.log("\uD83D\uDFE2 Google Sign-in successful!",{uid:t.uid,email:t.email,displayName:t.displayName,photoURL:t.photoURL}),t){console.log("\uD83D\uDD35 Starting unified authentication flow...");let{userData:r,navigationPath:o}=await (0,h.dt)(t,"google");console.log("\uD83D\uDFE2 Authentication flow completed!",{hasUsername:!!r.username,hasPhone:!!r.phone,hasEmail:!!r.email,providersCount:r.providers?Object.keys(r.providers).length:0,navigationPath:o}),r.username&&r.phone?(u.Am.success("Welcome back to Zest!"),console.log("\uD83D\uDFE2 Returning user with complete profile")):r.providers&&Object.keys(r.providers).length>1?(u.Am.success("Account linked successfully!"),console.log("\uD83D\uDFE2 Account linked with existing profile")):(u.Am.success("Welcome to Zest! Profile created successfully!"),console.log("\uD83D\uDFE2 New user profile created")),e&&e()}}catch(e){console.error("\uD83D\uDD34 Google Sign-in error:",e),e instanceof l.ZR?(console.log("\uD83D\uDD34 Firebase error details:",{code:e.code,message:e.message}),"auth/popup-closed-by-user"===e.code?u.Am.info("Sign-in cancelled"):"auth/popup-blocked"===e.code?u.Am.error("Popup was blocked. Please allow popups for this site."):"auth/account-exists-with-different-credential"===e.code?u.Am.error("An account already exists with this email using a different sign-in method."):"auth/invalid-credential"===e.code?u.Am.error("Invalid credentials. Please try again."):"auth/network-request-failed"===e.code?u.Am.error("Network error. Please check your connection and try again."):"auth/too-many-requests"===e.code?u.Am.error("Too many sign-in attempts. Please try again later."):u.Am.error(`Login failed: ${e.message}`)):(console.error("\uD83D\uDD34 Non-Firebase error during authentication:",e),u.Am.error("Error creating user profile. Please try again."))}finally{t(!1),console.log("\uD83D\uDD35 Google Sign-in process completed")}}}return(0,o.jsxs)("div",{children:[o.jsx("p",{className:g().loginContinueText,children:"Continue with Google"}),o.jsx("div",{style:{display:"flex",justifyContent:"center",cursor:r?"not-allowed":"pointer",opacity:r?.7:1},children:o.jsx(p,{disabled:r,onClick:c})}),!1]})};var f=t(97075);let _=(0,f.Z)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),D=(0,f.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var y=t(87097),v=t(78939),b=t.n(v);function w(){let[e,r]=(0,n.useState)({x:0,y:0}),[t,l]=(0,n.useState)(!1),[c,d]=(0,n.useState)(null),[p,m]=(0,n.useState)({name:"",username:"",phone:""}),[g,h]=(0,n.useState)({}),[f,v]=(0,n.useState)(!1),[w,N]=(0,n.useState)(!1),j=(0,s.useRouter)();(0,n.useEffect)(()=>{let e=e=>{r({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>window.removeEventListener("mousemove",e)},[]),(0,n.useEffect)(()=>{let e=(0,i.Aj)(a.I8,async e=>{e&&(console.log("âœ… User already logged in, checking profile..."),await k(e))});return()=>e()},[j]);let k=async e=>{try{let r=(0,y.JU)(a.db,"Users",e.uid),t=await (0,y.QT)(r);if(t.exists()){let r=t.data();if(r.username&&r.phone&&r.name){console.log("âœ… User has complete profile, redirecting to profile..."),j.push("/profile");return}console.log("\uD83D\uDCDD User exists but profile incomplete, showing form..."),d(e),m({name:r.name||e.displayName||"",username:r.username||"",phone:r.phone||""}),l(!0);return}console.log("\uD83D\uDCDD New user, needs to complete profile..."),d(e),m({name:e.displayName||"",username:"",phone:""}),l(!0)}catch(e){console.error("Error checking user profile:",e),u.Am.error("Error checking user profile. Please try again."),await (0,i.w7)(a.I8)}},P=async()=>{try{await (0,i.w7)(a.I8),l(!1),d(null),m({name:"",username:"",phone:""}),h({}),u.Am.success("Logged out successfully")}catch(e){console.error("Error signing out:",e),u.Am.error("Error signing out")}};(0,n.useEffect)(()=>{if(t){let e=e=>{e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?"},r=e=>{e.preventDefault(),window.history.pushState(null,"",window.location.href)};return window.addEventListener("beforeunload",e),window.addEventListener("popstate",r),window.history.pushState(null,"",window.location.href),()=>{window.removeEventListener("beforeunload",e),window.removeEventListener("popstate",r)}}},[t]);let S=async e=>{if(e.length<3)return!1;let r=(0,y.IO)((0,y.hJ)(a.db,"Users"),(0,y.ar)("username","==",e.toLowerCase())),t=await (0,y.PL)(r);return!!t.empty||(t.docs[0].data(),t.docs[0].id===c?.uid)},U=async e=>{let r=e.target.value.toLowerCase().trim();if(m(e=>({...e,username:r})),h(e=>({...e,username:""})),r.length>=3){v(!0);let e=await S(r);v(!1),e||h(e=>({...e,username:"Username is already taken"}))}},C=async e=>{if(e.preventDefault(),!c)return;let r={},t=p.name.trim(),o=p.username.trim(),n=p.phone;if(t||(r.name="Name is required"),o?o.length<3&&(r.username="Username must be at least 3 characters"):r.username="Username is required",n?10!==n.length&&(r.phone="Phone number must be 10 digits"):r.phone="Phone number is required",Object.keys(r).length>0){h(r);return}N(!0);try{if(n){let e=(0,y.IO)((0,y.hJ)(a.db,"Users"),(0,y.ar)("phone","==",n)),r=await (0,y.PL)(e);if(!r.empty&&r.docs[0].id!==c.uid){h(e=>({...e,phone:"This phone number is already linked to another account"})),N(!1);return}}if(!await S(o)){h(e=>({...e,username:"Username is already taken"})),N(!1);return}let e=(0,y.JU)(a.db,"Users",c.uid);await (0,y.pl)(e,{name:t,username:o.toLowerCase(),phone:n,updatedAt:new Date().toISOString(),uid:c.uid,email:c.email?.toLowerCase()||"",photo:c.photoURL||"",bio:"",createdAt:new Date().toISOString(),providers:{google:!0}},{merge:!0}),u.Am.success("Profile setup completed!"),j.push("/profile")}catch(e){console.error("Error updating profile:",e),u.Am.error("Error setting up profile")}finally{N(!1)}};return t?(0,o.jsxs)("div",{className:b().container,children:[(0,o.jsxs)("div",{className:b().backgroundAnimation,children:[o.jsx("div",{className:b().mouseFollower,style:{left:e.x,top:e.y}}),o.jsx("div",{className:b().gradientOrb1}),o.jsx("div",{className:b().gradientOrb2}),o.jsx("div",{className:b().gradientOrb3})]}),o.jsx("div",{className:b().content,children:(0,o.jsxs)("div",{className:b().card,children:[(0,o.jsxs)("button",{onClick:P,className:b().logoutButton,children:[o.jsx(_,{size:16}),"Logout"]}),(0,o.jsxs)("div",{className:b().cardContent,children:[(0,o.jsxs)("div",{className:b().header,children:[o.jsx("h1",{className:b().title,children:"Complete Your Profile"}),o.jsx("p",{className:b().subtitle,children:"Please complete your profile to continue using Zest"}),o.jsx("div",{className:b().profileInfo,children:o.jsx("p",{className:b().infoText,children:"\uD83D\uDCDD This is a one-time setup. You can logout if you need to use a different account."})})]}),(0,o.jsxs)("form",{onSubmit:C,className:b().profileForm,children:[(0,o.jsxs)("div",{className:b().inputGroup,children:[o.jsx("label",{className:b().inputLabel,children:"Name:"}),o.jsx("input",{type:"text",value:p.name,onChange:e=>m(r=>({...r,name:e.target.value})),className:b().profileInput,placeholder:"Enter your name"}),g.name&&o.jsx("span",{className:b().error,children:g.name})]}),(0,o.jsxs)("div",{className:b().inputGroup,children:[o.jsx("label",{className:b().inputLabel,children:"Username:"}),(0,o.jsxs)("div",{className:b().usernameContainer,children:[o.jsx("span",{className:b().usernamePrefix,children:"@"}),o.jsx("input",{type:"text",value:p.username,onChange:U,className:b().usernameInput,placeholder:"username"})]}),f&&o.jsx("span",{className:b().checking,children:"Checking availability..."}),g.username&&o.jsx("span",{className:b().error,children:g.username})]}),(0,o.jsxs)("div",{className:b().inputGroup,children:[o.jsx("label",{className:b().inputLabel,children:"Phone:"}),o.jsx("input",{type:"tel",value:p.phone,onChange:e=>{let r=e.target.value.replace(/\D/g,"").slice(0,10);m(e=>({...e,phone:r})),h(e=>({...e,phone:10===r.length?"":"Phone number must be 10 digits"}))},className:b().profileInput,placeholder:"Enter 10-digit phone number",maxLength:10}),g.phone&&o.jsx("span",{className:b().error,children:g.phone})]}),o.jsx("button",{type:"submit",disabled:w||f||Object.keys(g).some(e=>g[e]),className:b().completeButton,children:w?"Setting up...":"Complete Setup"})]})]})]})})]}):(0,o.jsxs)("div",{className:b().container,children:[(0,o.jsxs)("div",{className:b().backgroundAnimation,children:[o.jsx("div",{className:b().mouseFollower,style:{left:e.x,top:e.y}}),o.jsx("div",{className:b().gradientOrb1}),o.jsx("div",{className:b().gradientOrb2}),o.jsx("div",{className:b().gradientOrb3})]}),o.jsx("div",{className:b().content,children:(0,o.jsxs)("div",{className:b().card,children:[(0,o.jsxs)("button",{onClick:()=>{j.push("/")},className:b().backToHome,children:[o.jsx(D,{size:16}),"Back to Home"]}),(0,o.jsxs)("div",{className:b().cardContent,children:[(0,o.jsxs)("div",{className:b().header,children:[o.jsx("h1",{className:b().title,children:"Welcome to Zest"}),o.jsx("p",{className:b().subtitle,children:"Sign in to discover amazing events and activities"})]}),o.jsx("div",{className:b().primaryInputSection,children:o.jsx(x,{onSuccess:()=>{console.log("Google sign-in successful, waiting for auth state change...")}})}),(0,o.jsxs)("div",{className:b().organizationLink,children:[o.jsx("p",{className:b().organizationText,children:"Are you an organizer?"}),o.jsx("a",{href:"/login/organisation",className:b().organizationLinkBtn,children:"Organization Login"})]})]})]})})]})}},59753:(e,r,t)=>{"use strict";t.d(r,{dt:()=>l});var o=t(87097),n=t(81012);async function s(e,r){try{let t,s;if("email"===r||"google"===r){if(!e.email)return null;s=e.email.toLowerCase(),t=(0,o.IO)((0,o.hJ)(n.db,"Users"),(0,o.ar)("email","==",s))}else{if("phone"!==r||!e.phoneNumber)return null;s=e.phoneNumber,t=(0,o.IO)((0,o.hJ)(n.db,"Users"),(0,o.ar)("phone","==",s))}let i=await (0,o.PL)(t);if(!i.empty){let t=i.docs[0],s=t.data(),a=t.id;if(a===e.uid){let t={...s,providers:{...s.providers||{},[r]:!0},updatedAt:new Date().toISOString()};return await (0,o.pl)((0,o.JU)(n.db,"Users",e.uid),t,{merge:!0}),t}let l={...s,email:e.email?.toLowerCase()||s.email,phone:e.phoneNumber||s.phone,photo:e.photoURL||s.photo,name:e.displayName||s.name,providers:{...s.providers||{},[r]:!0},updatedAt:new Date().toISOString()};return await (0,o.pl)((0,o.JU)(n.db,"Users",a),l,{merge:!0}),a!==e.uid&&await (0,o.pl)((0,o.JU)(n.db,"Users",e.uid),{...l,uid:e.uid}),l}return null}catch(e){return console.error("Error linking accounts:",e),null}}async function i(e,r,t={}){let s={uid:e.uid,email:e.email?.toLowerCase()||t.email,phone:e.phoneNumber||t.phone,name:e.displayName||t.name||"",photo:e.photoURL||t.photo,username:t.username||"",bio:t.bio||"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),providers:{[r]:!0}};return await (0,o.pl)((0,o.JU)(n.db,"Users",e.uid),s),s}async function a(e,r,t={}){try{let s=(0,o.JU)(n.db,"Users",e),i=await (0,o.QT)(s);if(!i.exists())return null;let a=i.data(),l={...a,...t,providers:{...a.providers||{},[r]:!0},updatedAt:new Date().toISOString()};return await (0,o.pl)(s,l,{merge:!0}),l}catch(e){return console.error("Error updating user providers:",e),null}}async function l(e,r,t={}){try{console.log(`ðŸ”µ Starting authentication flow for ${r} provider`,{uid:e.uid,email:e.email,displayName:e.displayName,phoneNumber:e.phoneNumber}),console.log("\uD83D\uDD35 Checking for existing accounts to link...");let l=await s(e,r);if(l){console.log("\uD83D\uDFE2 Account linking successful!",{linkedProviders:Object.keys(l.providers||{}),hasUsername:!!l.username});let e=l.username?"/profile":"/";return{userData:l,navigationPath:e}}if(console.log("\uD83D\uDD35 No existing accounts found to link, checking for existing user document..."),!(await (0,o.QT)((0,o.JU)(n.db,"Users",e.uid))).exists())return console.log("\uD83D\uDD35 Creating new user document..."),l=await i(e,r,t),console.log("\uD83D\uDFE2 New user document created successfully!",{uid:l.uid,email:l.email,phone:l.phone,name:l.name,providers:Object.keys(l.providers||{})}),{userData:l,navigationPath:"/"};{if(console.log("\uD83D\uDD35 User document exists, updating providers..."),!(l=await a(e.uid,r,t)))throw Error("Failed to update user providers");console.log("\uD83D\uDFE2 User providers updated successfully!",{providers:Object.keys(l.providers||{}),hasUsername:!!l.username});let o=l.username?"/profile":"/";return{userData:l,navigationPath:o}}}catch(o){throw console.error("\uD83D\uDD34 Error in authentication flow:",o),console.error("\uD83D\uDD34 Error details:",{message:o instanceof Error?o.message:"Unknown error",stack:o instanceof Error?o.stack:void 0,user:{uid:e.uid,email:e.email,displayName:e.displayName},provider:r,additionalData:t}),o}}},78939:e=>{e.exports={container:"login_container__kitvQ",backgroundAnimation:"login_backgroundAnimation__VQtDP",mouseFollower:"login_mouseFollower__0oUmN",gradientOrb1:"login_gradientOrb1__YQvfO",pulse:"login_pulse__y44NG",gradientOrb2:"login_gradientOrb2__woM5L",float:"login_float__Wf_Ow",gradientOrb3:"login_gradientOrb3__R2VeE",content:"login_content__CW_6z",card:"login_card__NoG7p",backToHome:"login_backToHome__sP1ib",logoutButton:"login_logoutButton__DWBaO",cardContent:"login_cardContent__ornbS",header:"login_header__6nr4p",title:"login_title__r1aBc",subtitle:"login_subtitle__JqAz7",profileInfo:"login_profileInfo__QnfGN",infoText:"login_infoText__FYZDF",primaryInputSection:"login_primaryInputSection__3YjC0",organizationLink:"login_organizationLink__3rNMY",organizationText:"login_organizationText__4B2GO",organizationLinkBtn:"login_organizationLinkBtn__k0buN",profileForm:"login_profileForm__4jOyl",inputGroup:"login_inputGroup__WNCug",inputLabel:"login_inputLabel__STz_M",profileInput:"login_profileInput__7fjz3",usernameContainer:"login_usernameContainer__AfRE7",usernamePrefix:"login_usernamePrefix__pMV9s",usernameInput:"login_usernameInput__4bXMx",error:"login_error__wxSLK",checking:"login_checking__HpXsC",completeButton:"login_completeButton__bsmP8"}},12521:e=>{e.exports={googleButton:"GoogleButton_googleButton__osUN7",googleIcon:"GoogleButton_googleIcon__BOxDX"}},22734:e=>{e.exports={loginContinueText:"SignInwithGoogle_loginContinueText__1vju5"}},91613:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>s,__esModule:()=>n,default:()=>i});let o=(0,t(86843).createProxy)(String.raw`/Users/shreyasgurav/Documents/Projects/Zest Deployed/src/app/login/page.tsx`),{__esModule:n,$$typeof:s}=o,i=o.default}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[1638,4292,4684],()=>t(84448));module.exports=o})();